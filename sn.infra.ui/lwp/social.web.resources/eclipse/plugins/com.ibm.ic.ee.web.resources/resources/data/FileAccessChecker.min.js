/* Copyright IBM Corp. 2015  All Rights Reserved.                    */
define(["dojo","dojo/_base/declare","dojo/_base/lang"],function(c,g,f){return g("com.ibm.social.ee.data.FileAccessChecker",null,{fileId:null,routes:null,warningMessageKey:"WARNING_PRIVATE_GENERIC",eventHandles:[],constructor:function(a){c.safeMixin(this,a)},checkAccess:function(a){var b=this,d=this.routes.getACLUrl(this.fileId);this._networkHead({url:d,preventCache:!0,headers:{"X-LCONN-USER":a.data},handle:function(h,d){switch(d.xhr.status){case 200:if(b.eventHandles.isMember){var e=new c.Deferred;
e.addCallback(function(a){b.eventHandles.isMember(a);return a});e.callback(a)}b._handleComplete();break;case 403:b.eventHandles.notMember&&(e=new c.Deferred,e.addCallback(function(a){b.eventHandles.notMember(a);return a}),e.callback(a)),b._handleComplete()}},error:function(a,c){switch(c.xhr.status){case 403:break;default:b._handleError(a)}}})},_handleError:function(a){var b=this;if(this.eventHandles.error){var d=new c.Deferred;d.addCallback(function(a){b.eventHandles.error(a);return a});d.callback(a)}},
_handleComplete:function(){var a=this;if(this.eventHandles.onComplete){var b=new c.Deferred;b.addCallback(function(){a.eventHandles.onComplete()});b.callback()}},_networkGet:function(a){(f.getObject("com.ibm.social.as.util.xhr.XhrHandler")||c).xhrGet(a)},_networkHead:function(a){var b=f.getObject("com.ibm.social.as.util.xhr.XhrHandler");b?b.xhrHead(a):c.xhr("HEAD",a)},addCallback:function(a,b){this.eventHandles[a]=b}})});
